function tp__addRecord(o,i){edrec__closeEditForm(),$("#myfirstrecord")&&$("#myfirstrecord").css({display:"none"}),tp__ajax("/page/submit/",{comm:"addnewrecord",pageid:window.pageid,afterid:i,tplid:o},{ctext:"adding new block"},function(e){var t;tp__checkEmptyOrNotHtmlResponce(e)||(t=$(e).attr("id"),0<i?($("#record"+i).after(e),$("html, body").animate({scrollTop:$("#record"+i).offset().top+$("#record"+i).height()-100},700)):($("#allrecords").append(e),$("html, body").animate({scrollTop:$("#"+t).offset().top-100},700)),$("#"+t).css("opacity","0"),$("#"+t).animate({opacity:"1"},700,"easeInCirc"),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList(),"125"!=o&&"132"!=o&&"284"!=o&&"132"!=o)||location.reload()},function(){setTimeout(function(){location.reload()},3e3)})}function tp__checkEmptyOrNotHtmlResponce(e){return""==e?(td__showBubbleNotice("Error. Request response is empty. Please reload the page and try again.",6e3,"error"),!0):-1===e.indexOf('class="record"')&&(td__showBubbleNotice(e,6e3,"error"),!0)}function tp__dublicateRecord(t){$("#record"+t).find(".tp-record-edit-icons-right__wrapper").css("pointer-events","none").css("opacity","0.5"),tp__ajax("/page/submit/",{comm:"dublicaterecord",pageid:window.pageid,recordid:t},{ctext:"block duplicating"},function(e){tp__checkEmptyOrNotHtmlResponce(e)||($("#record"+t).after(e),$("html, body").animate({scrollTop:$("#record"+t).offset().top+$("#record"+t).height()-100},700),e=$(e).attr("id"),$("#"+e).css("opacity","0"),$("#"+e).animate({opacity:"1"},700,"easeInCirc"),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList())},function(){setTimeout(function(){location.reload()},3e3)},function(){$("#record"+t).find(".tp-record-edit-icons-right__wrapper").css("pointer-events","auto").css("opacity","1")})}function tp__delRecord(o){showLoadIcon(),$("#record"+o).find(".tp-record-edit-icons-right__wrapper").css("pointer-events","none").css("opacity","0.5"),tp__ajax("/page/submit/",{comm:"deleterecord",pageid:window.pageid,recordid:o},{ctext:"block deletion"},function(e){var t;""!=e&&"ok"!=e&&"OK"!=e?td__showBubbleNotice(e,6e3,"error"):((t=$("#record"+o)).slideUp("fast",function(){t.remove()}),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList())},function(){setTimeout(function(){location.reload()},3e3)},function(){$("#record"+o).find(".tp-record-edit-icons-right__wrapper").css("pointer-events","auto").css("opacity","1")})}function tp__recoverRecord(t){tp__ajax("/page/submit/",{comm:"recoverrecord",pageid:window.pageid,recordid:t},{ctext:"block recover"},function(e){""!=e&&"ok"!=e?td__showBubbleNotice(e,6e3,"error"):(tp__updateUndoButton(),tp__updateRecord(t))},function(){setTimeout(function(){location.reload()},3e3)})}function tp__updateRecord(t){showLoadIcon(),tp__ajax("/page/get/",{comm:"getrecordhtml",pageid:window.pageid,recordid:t},{ctext:"update block"},function(e){tp__checkEmptyOrNotHtmlResponce(e)||($("#record"+t).replaceWith(e),void 0!==window.blockList&&window.blockList.rebuildList())},function(){setTimeout(function(){location.reload()},3e3)})}function tp__updateRecord_fixed(t){showLoadIcon(),$.ajax({type:"POST",url:"/page/get/",data:{comm:"getrecordhtml",pageid:window.pageid,recordid:t},dataType:"text",success:function(e){check_logout(e),hideLoadIcon(),$("#record"+t).replaceWith(e),void 0!==window.blockList&&window.blockList.rebuildList()},error:function(e){alert("Request timeout (updating block)"),hideLoadIcon(),location.reload()},timeout:3e4})}function tp__upRecord(e){var t,o=$("#record"+e);o.prev().attr("recordid")&&(t=o.clone(),o.prev().before(t),o.remove(),tp__scrollTo(e),tp__record__addEditFieldEvents(e),tp__record__addEditOnReady(e),tp__record__onBordersdragmode(e),clearTimeout(autosavesort_timer),autosavesort_timer=setTimeout(function(){tp__saveRecordsSort()},4e3))}function tp__downRecord(e){var t,o=$("#record"+e);o.next().attr("recordid")&&(t=o.clone(),o.next().after(t),o.remove(),tp__scrollTo(e),tp__record__addEditFieldEvents(e),tp__record__addEditOnReady(e),tp__record__onBordersdragmode(e),clearTimeout(autosavesort_timer),autosavesort_timer=setTimeout(function(){tp__saveRecordsSort()},4e3))}function tp__offRecord(t){$("#record"+t).find(".tp-record-edit-icons-right__wrapper").css("pointer-events","none").css("opacity","0.5"),tp__ajax("/page/submit/",{comm:"offrecord",pageid:window.pageid,recordid:t},{ctext:"block off/on"},function(e){""!=e&&"y"!=e&&"n"!=e&&"on"!=e&&"off"!=e?td__showBubbleNotice(e,6e3,"error"):(("y"==e||"off"==e?tp__minifyRecord:($("#record"+t).find(".r").html(""),$("#record"+t).find(".r").css("min-height","65px"),$("#record"+t).attr("off","n"),tp__updateRecord_fixed))(t),tp__updateUndoButton())},function(){},function(){$("#record"+t).find(".tp-record-edit-icons-right__wrapper").css("pointer-events","auto").css("opacity","1")})}function tp__minifyRecord(e){var e=$("#record"+e),t=e.find(".tp-record-edit-icons-left__item-tplcod").html(),o=e.find(".tp-record-edit-icons-left__item-tpltitle").html(),t='<div style="display: flex; justify-content: center; padding: 15px 0; box-sizing: border-box; background-color: #eee; max-width: 100vw;"><div style="text-align: center; line-height: 30px; opacity: 0.7; cursor: default;"><b>'+((t=void 0===t?"":t)?t+". ":"")+(o=void 0===o?"":o)+"</b>. "+("y"!==window.$is_email?'<div style="line-height: 35px;">':"")+'<img src="https://static.tildacdn.com/lib/linea/0a73dde9-ce52-6771-0281-ee9e47000721/basic_eye_closed.svg" style="padding: 0 10px; width: 30px;">{{ hidden_block }}'+("y"!==window.$is_email?"</div>":"")+"</div></div>",t=tc__translate(t,"record__dict");e.find(".r").html(t),e.find(".r + div").remove(),e.find(".r").css("padding",""),e.find("#mainleft").css("display","none"),e.find(".tp-record-edit-icons-left__item-tpltitle").css("display","none"),e.attr("off","y")}function tp__changeRecordTpl(o,e){var t=tp__record__getFlag_keepcontentifchangerecordtpl();tp__ajax("/page/submit/",{comm:"changerecordtpl",pageid:window.pageid,recordid:o,tplid:e,flag_keepcontentifchangerecordtpl:t},{ctext:"changing block template"},function(e){var t=$("#record"+o);e.indexOf('class="record"')?t.replaceWith(e):t.html(e),0==$("#record"+o).height()&&$("#record"+o).height("120"),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList()},function(){})}function tp__addFishRecord(o,e,i){edrec__closeEditForm(),$("#myfirstrecord")&&$("#myfirstrecord").css({display:"none"}),tp__ajax("/page/submit/",{comm:"addfishrecord",pageid:window.pageid,afterid:i,fishid:e},{ctext:"adding new block on page"},function(e){var t;tp__checkEmptyOrNotHtmlResponce(e)||(t=$(e).attr("id"),0<i?($("#record"+i).after(e),$("html, body").animate({scrollTop:$("#record"+i).offset().top+$("#record"+i).height()-100},700)):($("#allrecords").append(e),$("html, body").animate({scrollTop:$("#"+t).offset().top-100},700)),$("#"+t).css("opacity","0"),$("#"+t).animate({opacity:"1"},700,"easeInCirc"),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList(),"125"!=o&&"132"!=o&&"284"!=o&&"132"!=o)||location.reload()},function(){setTimeout(function(){location.reload()},3e3)})}function tp__record__addEditUi(e,i){"object"!=typeof $tpls&&(console.log("ERROR! $tpls is not set"),$tpls=[]);var t,o,r=[],d=($tpls.forEach(function(e,t,o){e.id==i&&(r=e)}),300),n=$("#record"+e),a="",c=(n.prepend(a='<div class="recordbordertop"></div>'),a='<div class="recordborderbottom"></div>',n.append(a+='<div class="insertafterrecorbutton"><center><a href="javascript:tp__library__open(\''+e+'\');"><img src="/tpl/img/page/tp-08-add.svg"></a></center></div>'),void 0===r.id&&(r.id=i,void 0!==n.attr("data-record-category")&&(r.type=n.attr("data-record-category")),void 0!==n.attr("data-record-cod")&&(r.cod=n.attr("data-record-cod")),r.editnotpublish="",r.title=""),a='<div class="recordediticons mainleft" id="mainleft">',a+='<div class="tp-record-edit-icons-left__wrapper">',"396"!==i&&"421"!==i&&"121"!==i&&void 0!==r.type&&""!==r.type&&void 0!==r.cod&&""!==r.cod&&(a=(a+='<div class="tp-record-edit-icons-left__one">')+'<div class="tp-record-edit-icons-left__item"><div class="tp-record-edit-icons-left__dropdown-toggle" onclick="javascript:tp__record__showLefdropdown(\''+e+"');\">",void 0!==r.cod&&""!==r.cod&&(a+='<div class="tp-record-edit-icons-left__item-tplcod">'+r.cod+"</div>"),a+='<div class="tp-record-edit-icons-left__item-dropicon dropdown-arrow"></div></div><div class="tp-record-edit-icons-left__dropdown-menu"></div></div></div>'),a=(a=(a=(a=(a=(a+='<div class="tp-record-edit-icons-left__one-right-space">')+"</div>"+'<div class="tp-record-edit-icons-left__two">')+('<div class="tp-record-edit-icons-left__item" onclick="edrec__editRecordSettings(\''+e+"');\">")+'<div class="tp-record-edit-icons-left__item-icon">')+'<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M13.5877 5.63828L12.0273 5.37324C11.939 5.09351 11.8212 4.82858 11.6887 4.56355L12.6014 3.28283C12.7339 3.09142 12.7192 2.8265 12.5573 2.66454L11.3059 1.41318C11.144 1.25124 10.8791 1.22177 10.6876 1.36902L9.4069 2.28171C9.15665 2.14925 8.87694 2.03147 8.59721 1.94315L8.34696 0.3975C8.3028 0.161936 8.1114 0 7.87583 0H6.10931C5.87374 0 5.68244 0.161939 5.63817 0.3975L5.37324 1.95792C5.09351 2.04624 4.82858 2.16402 4.56355 2.29649L3.28283 1.3838C3.09142 1.25133 2.8265 1.26601 2.66454 1.42795L1.41318 2.67931C1.25124 2.84125 1.22177 3.10617 1.36902 3.2976L2.28171 4.57832C2.14925 4.82857 2.03147 5.10829 1.94315 5.38802L0.3975 5.63827C0.161936 5.68242 0 5.87383 0 6.1094V7.87592C0 8.11148 0.161939 8.30278 0.3975 8.34705L1.95792 8.61198C2.04624 8.89171 2.16402 9.15664 2.29649 9.42168L1.3838 10.7024C1.25133 10.8938 1.26601 11.1587 1.42795 11.3207L2.67931 12.572C2.84125 12.734 3.10617 12.7635 3.2976 12.6162L4.57832 11.7035C4.82857 11.836 5.10829 11.9538 5.38802 12.0421L5.65295 13.6025C5.6971 13.8381 5.88851 14 6.12408 14H7.8906C8.12617 14 8.31747 13.8381 8.36173 13.6025L8.61198 12.0273C8.89171 11.939 9.15664 11.8212 9.42168 11.6887L10.7024 12.6014C10.8938 12.7339 11.1587 12.7192 11.3207 12.5572L12.572 11.3059C12.734 11.144 12.7635 10.879 12.6162 10.6876L11.7035 9.40688C11.836 9.15663 11.9538 8.87691 12.0421 8.59718L13.6025 8.33225C13.8381 8.2881 14 8.09669 14 7.86112L13.9999 6.10927C13.9852 5.87381 13.8233 5.6824 13.5877 5.63824L13.5877 5.63828ZM6.99261 9.50996C5.59412 9.50996 4.47523 8.3764 4.47523 6.99258C4.47523 5.59409 5.60879 4.4752 6.99261 4.4752C8.37643 4.4752 9.51 5.59406 9.51 6.99258C9.51 8.3911 8.39113 9.50996 6.99261 9.50996Z" fill="#333333"/></svg>'+"</div>")+'<div class="tp-record-edit-icons-left__item-title"><span class="recordedit_mainleft_but_settings_title">{{settings}}</span></div>'+"</div>")+"</div>"+'<div class="tp-record-edit-icons-left__three">',a="396"!==i&&"421"!==i?a+'<div class="tp-record-edit-icons-left__item" onclick="edrec__editRecordContent(\''+e+'\');"><div class="tp-record-edit-icons-left__item-icon"><img src="/tpl/img/page/tp-03-edit.svg"></div><div class="tp-record-edit-icons-left__item-title"><span class="recordedit_mainleft_but_settings_title">{{content}}</span></div></div>':a+'<div class="tp-record-edit-icons-left__item" onclick="tp__openZero(\''+e+'\');"><div class="tp-record-edit-icons-left__item-icon"><img src="/tpl/img/page/tp-03-edit.svg"></div><div class="tp-record-edit-icons-left__item-title"><span class="recordedit_mainleft_but_settings_title">{{block_editor}}</span></div></div>',a+="</div>","754"!==i&&"776"!==i&&"778"!==i&&"786"!==i&&"951"!==i&&"973"!=i&&"1025"!=i||0<$("#rec"+e).find(".t-store").length&&0<$("#rec"+e).find(".t-store").attr("data-storepart")&&(d=400,$("#rec"+e).find(".t-store").attr("data-storepart"),a=(a+='<div class="tp-record-edit-icons-left__four">')+"<a href='https://tilda.cc/identity/gostore/?projectid="+window.projectid+'\' target=\'_blank\'><div class="tp-record-edit-icons-left__item"><div class="tp-record-edit-icons-left__item-icon"><img src="/tpl/img/page/tp-16-products.svg" width="14px" style="width:14px;"></div><div class="tp-record-edit-icons-left__item-title"><span class="recordedit_mainleft_but_settings_title">{{products}}</span></div></div></a></div>'),"896"!==i&&"897"!==i&&"915"!==i&&"924"!==i&&"925"!==i&&"1004"!==i||0<$("#rec"+e).find(".t-feed").length&&""!=$("#rec"+e).find(".t-feed").attr("data-feedpart")&&"5d9725a245f86259476957"!=(c=$("#rec"+e).find(".t-feed").attr("data-feedpart"))&&"5d971e17b674f464032195"!=c&&"873491564841"!=c&&(d=385,a=(a+='<div class="tp-record-edit-icons-left__four">')+"<a href='https://tilda.cc/identity/gofeeds/?projectid="+window.projectid+(c?"&feeduid="+c:"")+'\' target=\'_blank\'><div class="tp-record-edit-icons-left__item"><div class="tp-record-edit-icons-left__item-icon"><img src="/tpl/img/page/tp-17-news.svg" width="12px" style="width:12px;"></div><div class="tp-record-edit-icons-left__item-title"><span class="recordedit_mainleft_but_settings_title">{{posts}}</span></div></div></a></div>'),void 0!==r.editnotpublish&&"y"==r.editnotpublish&&(a+='<div class="tp-record-edit-icons-left__four"><div class="tp-record-edit-icons-left__item" onclick="showCornerNotice(\'{{note_diff_edit_and_publish}}\',8000);"><div class="tp-record-edit-icons-left__item-icon"><span class="fa fa-comment" style="color:#ffcf5d;"></span></div></div></div>'),a=a+" </div>"+"</div>",void 0===r.title&&void 0===r.title_ru||(a+='<div class="recordediticons secondleft tp-record-edit-icons-left__item-tpltitle">'+("RU"==lang&&void 0!==r.title_ru&&""!=r.title_ru?r.title_ru:void 0!==r.title&&""!=r.title?r.title:"")+"</div>"),a=tc__translate(a,"record__dict"),n.prepend(a),a='<div class="recordediticons mainright" id="rightbuttons">',a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a+='<div class="tp-record-edit-icons-right__wrapper">')+'<div class="tp-record-edit-icons-right__one">'+'<div class="tp-record-edit-icons-right__items">')+('<div class="tp-record-edit-icons-right__item-icon tp-record-edit-icons-right__item-icon_right-border" onclick="tp__dublicateRecord(\''+e+'\');" data-toggle="tooltip" data-placement="top" title="{{duplicate}}" ><img src="/tpl/img/page/tp-04-duplicate.svg"></div>')+('<div class="tp-record-edit-icons-right__item-icon tp-record-edit-icons-right__item-icon_right-border" onclick="tp__delRecord(\''+e+'\');" data-toggle="tooltip" data-placement="top" title="{{delete}}"><img src="/tpl/img/page/tp-05-delete-3.svg"></div>'))+('<div class="tp-record-edit-icons-right__item-icon tp-record-edit-icons-right__item-icon_right-border " onclick="tp__offRecord(\''+e+'\');" data-toggle="tooltip" data-placement="top" title="{{hide_show}}"><img src="/tpl/img/page/tp-05-off.svg"></div>')+'<div type="button" class="tp-record-edit-icons-right__item-icon dropdown-toggle dropdown-arrow" style="padding-top:2px; padding-right:3px;width:24px;" data-toggle=""></div>')+'<ul class="dropdown-menu">'+("<li><a href=\"javascript:tp__record__bufCut('"+e+'\');" style="padding-left:0px;color:#000;">{{cut}}</a></li>'))+("<li><a href=\"javascript:tp__record__bufCopy('"+e+'\');" style="padding-left:0px;color:#000;">{{copy}}</a></li>')+("<li><a href=\"javascript:tp__record__bufPaste('"+e+'\');" style="padding-left:0px;color:#000;">{{paste}}</a></li>'))+("<li><a href=\"javascript:tp__selectModeOn('"+e+'\');" style="padding-left:0px;color:#000;">{{select}}</a></li>')+"</ul>")+"</div>"+"</div>")+'<div class="tp-record-edit-icons-right__one-right-space">'+"</div>")+'<div class="tp-record-edit-icons-right__two">'+'<div class="tp-record-edit-icons-right__items">')+('<div class="tp-record-edit-icons-right__item-icon btn-sort-recup" style="display:table-cell !important; border-right:1px #ccc solid;" onclick="tp__upRecord(\''+e+'\');" data-toggle="tooltip" data-placement="top" title="{{move_up}}">')+'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M4.375 5.78947V12H6.625V5.78947H10L5.5 0L1 5.78947H4.375Z" fill="#000000"/></svg>')+"</div>"+('<div class="tp-record-edit-icons-right__item-icon btn-sort-recdown" style="display:table-cell !important;"  onclick="tp__downRecord(\''+e+'\');" data-toggle="tooltip" data-placement="top" title="{{move_down}}">'))+'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6.625 6.21053L6.625 -2.95052e-07L4.375 -4.91753e-07L4.375 6.21053L1 6.21053L5.5 12L10 6.21053L6.625 6.21053Z" fill="#000000"/></svg>'+"</div>")+"</div>"+"</div>")+"</div>"+"</div>",n.prepend(tc__translate(a,"record__dict")),$("#record"+e).find(".t-video-lazyload").length&&tc__onFuncLoad("t_video_lazyload__addVideoWithCheckViewport",function(){t_video_lazyload__addVideoWithCheckViewport()}),n.find(".r"));void 0===c.attr("data-screenmin")&&void 0===c.attr("data-screenmax")||(o=t=a="",o='<div class="recordediticons diplayrestriction" style="left:'+d+'px;" title="{{set_width_viewport_limit}}">'+(o=(o=(o+='<img src="https://static.tildacdn.com/lib/linea/bd5071b9-9e2d-2fa7-4562-c8c427f961ba/basic_eye.svg" style="width:18px; padding-right:8px;">')+"{{from}}"+(""==(a=void 0!==c.attr("data-screenmin")&&""!=c.attr("data-screenmin")?c.attr("data-screenmin"):a)?"0px":a))+" {{to}} "+(""==(t=void 0!==c.attr("data-screenmax")&&""!=c.attr("data-screenmax")?c.attr("data-screenmax"):t)?"&infin;":t))+"</div>",o=tc__translate(o,"record__dict"),n.prepend(o)),"0px"==c.css("padding-top")&&n.find(".recordbordertop").css("height","10px"),"0px"==c.css("padding-bottom")&&n.find(".recordborderbottom").css("height","10px").css("margin-top","-10px"),"y"==n.attr("off")&&tp__minifyRecord(e),void 0!==n.attr("data-record-trash")&&"y"==n.attr("data-record-trash")&&(o='<div class="recordediticons" style="display:block;z-index:1001;left:20px;background:yellow;padding:6px 15px;cursor:pointer;font-weight:500;" title="" onclick="tp__recoverRecord(\''+e+"');\">{{recover_from_trash}}</div>",o=tc__translate(o,"record__dict"),n.prepend(o),n.find(".mainright").remove(),n.find(".mainleft").remove()),tp__record__onBordersdragmode(e),n.height()<1&&n.css("min-height","100px")}function tp__record__addEditFieldEvents(i){var e=$("#record"+i);0!=e.length&&"121"!=e.attr("data-record-type")&&(e.find("[field]").click(tp__record__editField),e.find("[imgfield]").hover(function(){$(this).css("opacity",.7)},function(){$(this).css("opacity",1)}),$("#record"+i+" [imgfield], #record"+i+" [bgimgfield]").each(function(){var e=$(this),t=e.attr("id"),o="";void 0!==e.attr("imgfield")&&(o=e.attr("imgfield")),void 0!==e.attr("bgimgfield")&&(o=e.attr("bgimgfield")),t||(t="tuwidget"+parseInt(Math.floor(Math.random()*(9e5+1))+99999),e.attr("id",t)),TUWidget.init(e).done(function(e){var t=$("#"+this.elementid),t=(t.attr("bgimgfield"),t.trigger("tuwidget_done",e),showLoadIcon(),{});t.comm="saverecord",t.pageid=window.pageid,t.recordid=i,t.onlythisfield=o,t[o+"-uploadmethod"]="tu",t[o+"-tuinfo-uuid"]=e.tuInfo.uuid,t[o+"-tuinfo-cdnurl"]=e.tuInfo.cdnUrl,t[o+"-tuinfo-name"]=e.tuInfo.name,t[o+"-tuinfo-width"]=e.tuInfo.width,t[o+"-tuinfo-size"]=e.tuInfo.size,$.ajax({type:"POST",url:"/page/submit/",data:t,dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),""==e||"OK"==e?($("html, body").animate({scrollTop:$("#record"+i).offset().top-50+Math.floor(100*Math.random()+1)},700),tp__updateRecord(i)):alert(e)},error:function(){hideLoadIcon(),alert("Request timeout (saving image)")},timeout:9e4})})}))}function tp__record__showUpDownIcons(e){e=$("#record"+e);"y"==e.find(".btn-sort-recup").attr("data-vis")?(e.find(".btn-sort-recup").removeAttr("style").removeAttr("data-vis"),e.find(".btn-sort-recdown").removeAttr("style").removeAttr("data-vis")):(e.find(".btn-sort-recup").attr("style","display: table-cell !important;").attr("data-vis","y"),e.find(".btn-sort-recdown").attr("style","display: table-cell !important;").attr("data-vis","y"))}function tp__record__addEditUiDel(e){var t="",t='<div class="recordbordertop"></div>';$("#record"+e).prepend(t),t='<div class="recordborderbottom"></div>',$("#record"+e).append(t),t=(t='<div class="recordediticons mainright" id="rightbuttons"><div class="tp-record-edit-icons-right__wrapper"><div class="tp-record-edit-icons-right__one">')+'<div class="tp-record-edit-icons-right__items"><div class="tp-record-edit-icons-right__item-icon tp-record-edit-icons-right__item-icon_right-border" onclick="tp__delRecord(\''+e+'\');" data-toggle="tooltip" data-placement="top" title="Delete"><img src="/tpl/img/page/tp-05-delete-3.svg"></div></div></div></div></div>',$("#record"+e).prepend(t),"y"==$("#record"+e).attr("off")&&$("#record"+e).css("opacity","0.4"),$("#record"+e).height()<1&&$("#record"+e).css("min-height","100px")}function tp__record__addEditOnReady(e){$("#record"+e).find(".tp-tplswitch-item").click(function(){window.clearInterval(window.stickloop),$(".tp-tplswitch-item__icon").remove()})}function tp__record__stick_div_to_mouse(e){var t,o,i;void 0===o&&(t=0,o=350,i=100),$(document).mousemove(function(e){e.pageX,t=e.pageY}),window.stickloop=setInterval(function(){i+=(t-40-i)/12,$(e).css({left:o+"px",top:i+"px"})},30)}function tp__record__onBordersdragmode(e){var o="",i="",r="",d="",r="";$(".recordbordertop").draggable({axis:"y",grid:[15,15],revert:!0,start:function(e,t){d=parseInt($(this).parent().find(".r").css("padding-top")),r=$(this).offset().top,$(this).before('<div class="recordbordertop" id="bordercloned"></div>'),tp__record__drawBorderdraghelper($(this).parent(),"")},drag:function(e,t){o=$(this).offset().top-r,(i=d+o)<0&&(i=0),$(this).parent().find(".r").css("padding-top",i+"px"),$(this).css("display","block"),$(this).css("opacity","0.1"),$("#borderhelper_l").html((i/30).toFixed(1)),$("#borderhelper_r").html(i+"px")},stop:function(){$(this).css("opacity","1"),r=i=o="",showLoadIcon(),tp__record__removeBorderdraghelper();var e=15*Math.round(parseFloat($(this).parent().find(".r").css("padding-top"))/15),t=(210<e&&(e=210),e+="px",$(this).parent().attr("recordid"));$(this).parent().find("#bordercloned").remove(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"saverecord",pageid:window.pageid,recordid:t,margintop:e,onlythisfield:"margintop"},dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),""!=e&&"OK"!=e||(tp__updateRecord(t),tp__updateUndoButton())},error:function(){hideLoadIcon()},timeout:3e4})}}),$(".recordborderbottom").draggable({axis:"y",grid:[15,15],start:function(){d=Math.round(parseFloat($(this).parent().find(".r").css("padding-bottom"))),r=Math.round(parseFloat($(this).offset().top)),tp__record__drawBorderdraghelper($(this).parent(),"bottom")},drag:function(){o=$(this).offset().top-r,(i=d+o)<0&&(i=0),$(this).parent().find(".r").css("padding-bottom",i+"px"),$(this).css("display","block"),$("#borderhelper_l").html((i/30).toFixed(1)),$("#borderhelper_r").html("("+i+"px)")},stop:function(){r=i=o="",showLoadIcon(),tp__record__removeBorderdraghelper();var e=15*Math.round(parseFloat($(this).parent().find(".r").css("padding-bottom"))/15),t=(210<e&&(e=210),e+="px",$(this).parent().attr("recordid"));$.ajax({type:"POST",url:"/page/submit/",data:{comm:"saverecord",pageid:window.pageid,recordid:t,marginbottom:e,onlythisfield:"marginbottom"},dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),""!=e&&"OK"!=e||(tp__updateRecord(t),tp__updateUndoButton())},error:function(){hideLoadIcon()},timeout:3e4})}})}function tp__record__drawBorderdraghelper(e,t){var o="";e.append(o+='<div id="borderhelper" style="background-color:#000;color:#fff;pointer-events:none;padding:9px 10px;position:absolute;left:calc(50% - 50px); border-radius:20px; '+("bottom"==t?"bottom:20px;":"top:15px;")+' width:80px; text-align:center;opacity:0;font-size:13px;">&nbsp;<span id="borderhelper_l" style=""></span>&nbsp;&nbsp;&nbsp;<span id="borderhelper_r" style="opacity:0.4;"></span></div>'),$("#borderhelper").animate({opacity:.9},200)}function tp__record__removeBorderdraghelper(){$("#borderhelper").animate({opacity:0},300),setTimeout(function(){$("#borderhelper").remove()},300)}function tp__record__showLefdropdown(e){var t=$("#record"+e),o=t.find(".tp-record-edit-icons-left__dropdown-menu"),i=t.attr("data-record-type");if(0===o.find(".tp-record-edit-icons-left__dropdown-menu-ul").length){"object"!=typeof $tpls&&(console.log("ERROR! $tpls is not set"),$tpls=[]);for(var r=[],d=($tpls.forEach(function(e,t,o){e.id==i&&(r=e)}),void 0===r.id&&(r.id=i,void 0!==t.attr("data-record-category"))&&(r.type=t.attr("data-record-category")),[]),t=($tpls.forEach(function(e,t,o){e.type==r.type&&"396"!==e.id&&"421"!==e.id&&(d[d.length]=e)}),tp__record__getFlag_keepcontentifchangerecordtpl()),n="",a=0,c=("undefined"!=typeof $uplan&&0<$uplan&&(a=$uplan),"undefined"!=typeof $oplan&&0<$oplan&&(a=$oplan),""),s=(c=c+('<div class="tp-record-edit-icons-left__dropdown-menu-flag '+("y"==t?"tp-record-edit-icons-left__dropdown-menu-flag_checked":"")+'" onclick="tp__record__toggleFlag_keepcontentifchangerecordtpl();"><img src="/tpl/img/t-icon-switcher-off.png" class="tp-record-edit-icons-left__switcher-off" width=\'40px\' height=\'25px\'><img src="/tpl/img/t-icon-switcher-on.png" class="tp-record-edit-icons-left__switcher-on" width=\'40px\' height=\'25px\'>{{save_content_on_switch}}<div class=\'tp-record-edit-icons-left__switcher-on-hint\' style="'+("y"!=t?"display:none;":"")+'">{{block_may_look_unbalanced}}</div></div>')+'<ul class="tp-record-edit-icons-left__dropdown-menu-ul">',0),l=0;l<d.length;l++)void 0!==d[l].disableforplan0&&"y"==d[l].disableforplan0&&"0"==a||void 0!==d[l].disableforplan1&&"y"==d[l].disableforplan1&&"1"==a||(n="",void 0!==d[l].icon&&""!==d[l].icon&&(n=0===d[l].icon.indexOf("https://static.")?d[l].icon:"https://assets.tildacdn.com/files/tplicons/tpl_"+d[l].id+".png"),c+="<li><a href=\"javascript:tp__changeRecordTpl('"+e+"','"+d[l].id+'\');" class="tp-tplswitch-item" data-tplinfo-icon="'+n+'"><span '+(i==d[l].id?'style="opacity:0.3;"':"")+">"+d[l].cod+":</span> "+("RU"==lang&&void 0!==d[l].title_ru&&""!==d[l].title_ru?d[l].title_ru:d[l].title)+"</a></li>",s++);c+="</ul>",0<s&&(c=tc__translate(c,"record__dict"),o.html(c)),o.find(".tp-tplswitch-item").hover(function(){var e=$(this).attr("data-tplinfo-icon");0===$(".tp-tplswitch-item__icon").length?($("body").append($('<div class="tp-tplswitch-item__icon"><img src="'+e+'"></div>')),tp__record__stick_div_to_mouse(".tp-tplswitch-item__icon")):$(".tp-tplswitch-item__icon").find("img").attr("src",e),window.clearInterval(window.stickloopclose)},function(){window.stickloopclose=setTimeout(function(){window.clearInterval(window.stickloop),$(".tp-tplswitch-item__icon").remove()},30)})}o.toggleClass("tp-record-edit-icons-left__dropdown-menu_opened"),o.mouseleave(function(){o.removeClass("tp-record-edit-icons-left__dropdown-menu_opened"),$(".tp-tplswitch-item__icon").remove(),void 0!==window.stickloop&&window.clearInterval(window.stickloop)}),o.find("a").click(function(){o.removeClass("tp-record-edit-icons-left__dropdown-menu_opened"),$(".tp-tplswitch-item__icon").remove(),void 0!==window.stickloop&&window.clearInterval(window.stickloop)})}function tp__record__toggleFlag_keepcontentifchangerecordtpl(){var e=tp__record__getFlag_keepcontentifchangerecordtpl();tp__record__setFlag_keepcontentifchangerecordtpl(e="y"==e?($(".tp-record-edit-icons-left__dropdown-menu-flag").removeClass("tp-record-edit-icons-left__dropdown-menu-flag_checked"),$(".tp-record-edit-icons-left__switcher-on-hint").css("display","none"),""):($(".tp-record-edit-icons-left__dropdown-menu-flag").addClass("tp-record-edit-icons-left__dropdown-menu-flag_checked"),$(".tp-record-edit-icons-left__switcher-on-hint").css("display","block"),"y"))}function tp__record__getFlag_keepcontentifchangerecordtpl(){var e="";return void 0===window.tp_flag_keepcontentifchagerecordtpl?(e="y"==(e=localStorage.getItem("tp-flag-keepcontentifchagerecordtpl"))?"y":"",window.tp_flag_keepcontentifchagerecordtpl=e):e=window.tp_flag_keepcontentifchagerecordtpl,e}function tp__record__setFlag_keepcontentifchangerecordtpl(e){localStorage.setItem("tp-flag-keepcontentifchagerecordtpl",e),window.tp_flag_keepcontentifchagerecordtpl=e}function tp__record__showMapCritycalText(e,t){var o,e=$("#record"+e+'[off="n"]');0!=e.length&&(o='Error! Provider "'+t+'" is not found.',"google"===t?o="{{maps_google_critycal_text}}":"yandex"===t&&(o="{{maps_yandex_critycal_text}}"),o='<div style="margin: 0px;text-align: left; font-family: tfutura,Arial; position: relative; max-width: 100%;"><div style=" background: yellow; padding: 40px 40px;"><div style="width: 40px; height: 40px; float: left; display: inline-block;margin-left: 80px;margin-top: -80px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><path fill="#ff0" d="M0 40l40-20v20H0z"/></svg></div>'+o+"<br></div></div>",o=tc__translate(o,"record__dict"),e.find(".r").after(o))}function tp__record__showFormCritycalText(e,t,o,i,r,d){var n,a,c="",s=$("#record"+e);return 0!=s.length&&0!=s.find(".js-errorbox-all").length&&("NO"==t&&(c+='<span style="font-weight: 300">{{forms_success_connected}}</span> <span style="font-weight: 500">'+o+'</span><br><span style="font-weight: 300">{{forms_data_will_be_sent}}</span> <span style="font-weight: 500">'+(i=$("<textarea>").html(i).text())+"</span>"),"NEED_INPUT_SCRIPT"==t&&(a=n="",0<$("#allrecords").data("tilda-project-id")&&(n="<a href='/projects/settings/?projectid="+$("#allrecords").data("tilda-project-id")+"#tab=ss_menu_forms'>",a="</a>"),c+="{{forms_has_not_script|abeg|aend}}"),"NEED_CONNECT_RECEIVER"==t&&(c+="{{forms_has_not_data_receiver}}"),"yes"==r&&"NO"==t&&(c+="<br><br><b>{{forms_page_need_publish}}</b>"),"NO"==t&&"yes"!=r||(c='<div style="margin: 0px;text-align: left; font-family: tfutura,Arial; position: relative;"><div style="max-width: 100%; background: yellow; padding: 40px 40px; box-sizing: border-box;" class="t-container"><div style="width: 40px; height: 40px; float: left; display: inline-block;margin-left: 80px;margin-top: -80px;"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height = "40px"  width = "40px"><polygon fill="yellow" stroke="yellow" stroke-width="0" points="0,40  40,20 40,40 0,40" /></svg></div>'+c+"<br></div></div>",c=tc__translate(c,"record__dict",{abeg:n,aend:a}),$("#record"+e+" .r").after(c)),!0)}function tp__record__showCritycalText(e,t){var o="";return 0!=$("#record"+e).length&&("OLDTPL"==t?o="{{blocks_critycal_text}}":"string"==typeof t&&""!==t&&(o=t),""!=o&&(o='<div style="margin: 0px;text-align: left; font-family: tfutura,Arial; position: relative;"><div style="max-width: 100%; background: yellow; padding: 40px 40px; box-sizing: border-box;" class="t-container"><div style="width: 40px; height: 40px; float: left; display: inline-block;margin-left: 80px;margin-top: -80px;"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height = "40px"  width = "40px"><polygon fill="yellow" stroke="yellow" stroke-width="0" points="0,40  40,20 40,40 0,40" /></svg></div>'+o+"<br></div></div>",o=tc__translate(o,"record__dict"),$("#record"+e+" .r").after(o)),!0)}function tp__record__editField(){var e;"q"===window.ver_redactor?(e=this,setTimeout(function(){tp__record__editField_quill($(e))})):tp__record__editField_v2($(this))}function tp__record__editField_quill(d){var n,a,e,t,o,i,r,c;function s(e){var t=d.find(".ql-editor"),o=$("#for_redactor_toolbar"),i=$(".quill-modal"),r=$(e.target).closest(".quill-tooltip");$(e.target).closest(t).length||$(e.target).closest(o).length||0!==i.length||!d.find(".ql-editor").length||r.length||(t=Quill.getFormatContent(d.find(".ql-editor")[0]),d[0].innerHTML=t,d.bind("click",tp__record__editField),$(document).off("click",s),$("#for_redactor_toolbar").finish(),$("#mainmenu").finish(),$("#for_redactor_toolbar").animate({opacity:"0",top:"-60px"},400,"easeInCirc",function(){$("#for_redactor_toolbar").html(""),$("#mainmenu").animate({opacity:"1",top:"0px"},300,"easeOutCirc")}),window.waschanged&&tp__record__saveEditedField(a,n),d.data("noclickatthistime","yes"))}"yes"==d.data("noclickatthistime")?d.data("noclickatthistime",""):($(".editinplacefield").each(function(){tp__record__saveEditedField(tp__getRecordid(d),d.parent().attr("field"))}),d.unbind("click",tp__record__editField),i=d.css(["height","color","background-color","font-size","font-family","line-height","font-weight","text-align","letter-spacing"]),n=d.attr("field"),a=tp__getRecordid(d),r=Quill.fixCustomStyle(d.html()),e=Quill.getCursorPosition(d[0]),(t=[])[n]=r.html,tempdatafields[a]=t,t=(t="")+'<div id="editrecord'+a+"field"+n+'" class="editinplacefield">'+r.html,d.html(t+="</div>"),$("#textarearecord"+a+"field"+n).css(i),d.find("#cnsleditrec").click(function(){var e=$("#record"+a+" [field='"+n+"']");e.html(tempdatafields[a][n]),e.data("noclickatthistime","yes"),e.click(tp__record__editField)}),d.find("#sveditrec").click(function(){tp__record__saveEditedField(a,n)}),$("#for_redactor_toolbar").stop(),$("#mainmenu").stop(),$("#for_redactor_toolbar").css("opacity","0"),"object"==typeof(d=d)&&"no"==d.attr("data-redactor-toolbar")||$("#mainmenu").animate({opacity:"0",top:"-60px"},400,"easeInCirc",function(){$("#for_redactor_toolbar").animate({opacity:"1",top:"0px"},300,"easeOutCirc")}),window.country||(window.country=$("body").data("country")),window.waschanged="",t=r.styles,o=$("#for_redactor_toolbar"),i={toolbar_content:{selector:"#for_redactor_toolbar",hint:!0,callback:function(e){var t=$(e.root).parent().parent().parent().attr("data-elem-id"),t=(void 0!==t&&!1!==t&&(o.find(".ql-color_custom").css("display","none"),o.find(".ql-weight_custom").css("display","none"),o.find(".ql-font_custom").css("display","none"),o.find(".ql-size_custom").css("display","none"),o.find(".ql-lineheight_custom").css("display","none"),o.find(".ql-align_custom").css("display","none")),o.find(".ql-list").css("display","none"),$(e.root).parent().parent().attr("data-redactor-notoolbar"));void 0!==t&&!1!==t&&o.find("button").css("display","none"),"y"==window.$is_email&&(o.find(".ql-weight_custom").css("display","none"),o.find(".ql-font_custom").css("display","none"),o.find(".ql-size_custom").css("display","none"),o.find(".ql-lineheight_custom").css("display","none"),o.find(".ql-align_custom").css("display","none"))}},popup:!0,tooltip:!0,dropdown:!0,textcolor:".ql-color_custom",weightDropdown:".ql-weight_custom",fontDropdown:".ql-font_custom",sizeDropdown:".ql-size_custom",lineheightDropdown:".ql-lineheight_custom",alignDropdown:".ql-align_custom",typograph:".ql-typograph_custom",cleanstyle:".ql-clean_custom",tilda_hotkeys:!0,toolbar:{container:"#for_redactor_toolbar",toolbarOptions:["bold","italic","underline",{list:"ordered"},{list:"bullet"},"link"]},more:".ql-more_custom"},r=$("#editrecord"+a+"field"+n).parent().attr("data-redactor-nohref"),void 0===r&&(i.tilda_link=".ql-link_custom"),c=new Quill("#editrecord"+a+"field"+n,{formats:["bold","color","font","italic","link","size","strike","underline","list","weight","lineheight","align","subscript","superscript","background"],debug:!1,modules:i}),Quill.setCustomStyles(c.root,t),tp__record__showTextStyle(c),c.on("editor-change",function(){window.waschanged="yes",tp__record__showTextStyle(c)}),void 0!==r&&!1!==r&&o.find(".ql-link_custom").css("display","none"),$("#editrecord"+a+"field"+n+" .ql-editor")[0].focus({preventScroll:!0}),e.start?c.setSelection(e.start,e.offset):c.focus(),$(document).off("mousedown",s),$(document).on("mousedown",s))}function tp__record__editField_v2(e){var t,o,i,r;"yes"==e.data("noclickatthistime")?e.data("noclickatthistime",""):($(".editinplacefield").each(function(){tp__record__saveEditedField(tp__getRecordid(e),e.parent().attr("field"))}),e.unbind("click",tp__record__editField),t=e.css(["height","color","background-color","font-size","font-family","line-height","font-weight","text-align","letter-spacing"]),o=e.attr("field"),i=tp__getRecordid(e),(r=[])[o]=e.html(),tempdatafields[i]=r,r=(r=(r="")+'<div id="editrecord'+i+"field"+o+'" class="editinplacefield"><textarea name="'+o+'" class="edittextarearecordfield" id="textarearecord'+i+"field"+o+"\" style='width:100%; border:0; margin:0; padding:0;'>")+tp__htmlEncode(e.html()),e.html(r=r+"</textarea>"+"</div>"),$("#textarearecord"+i+"field"+o).css(t),e.find("#cnsleditrec").click(function(){var e=$("#record"+i+" [field='"+o+"']");e.html(tempdatafields[i][o]),e.data("noclickatthistime","yes"),e.click(tp__record__editField)}),e.find("#sveditrec").click(function(){tp__record__saveEditedField(i,o)}),$("#for_redactor_toolbar").stop(),$("#mainmenu").stop(),$("#for_redactor_toolbar").html(""),$("#for_redactor_toolbar").css("opacity","0"),$("#mainmenu").animate({opacity:"0",top:"-60px"},400,"easeInCirc",function(){"object"==typeof e&&"no"==e.attr("data-redactor-toolbar")||$("#for_redactor_toolbar").animate({opacity:"1",top:"0px"},300,"easeOutCirc")}),window.country||(window.country=$("body").data("country")),window.waschanged="",$("#textarearecord"+i+"field"+o).redactor({lang:"RU"==lang?"ru":"en",buttons:["bold","italic","deleted","link",""],focus:!0,linebreaks:!0,allowedTags:["p","a","i","b","br","div","del","u","ul","ol","li","sup","sub","em","table","tr","td","th","tbody","thead","strike","span","inline","strong"],replaceDivs:!1,cleanOnPaste:!0,toolbarExternal:"#for_redactor_toolbar",plugins:"RU"==window.lang||"RU"==window.country||"BY"==window.country||"UA"==window.country?["underline","fontcolorex","fontweight","setfontfamily","setfontsize","setlineheight","setalign","typograf","clearstyle"]:["underline","fontcolorex","fontweight","setfontfamily","setfontsize","setlineheight","setalign","clearstyle"],dragUpload:!1,initCallback:function(e){1==this.$editor.has("div").is("div")&&(void 0!==(o=getAttrStrintoArr(this.$editor.find("div").attr("style")))["font-size"]&&""!=o["font-size"]&&this.setfontsize.enter(o["font-size"]),void 0!==o["line-height"]&&""!=o["line-height"]&&this.setlineheight.enter(o["line-height"]),void 0!==o["text-align"]&&""!=o["text-align"]&&this.setalign.enter(o["text-align"]),void 0!==o["font-family"]&&""!=o["font-family"]&&this.setfontfamily.enter(o["font-family"]),void 0!==o.color&&""!=o.color&&this.fontcolorex.enter(o.color),this.$editor.find("div").contents().unwrap()),redactor_showTextSyle(this);var t,o=this.$editor.parent().parent().parent().parent().attr("data-elem-id"),o=(void 0!==o&&!1!==o&&((t=$("#for_redactor_toolbar")).find(".re-fontcolor").css("display","none"),t.find(".re-fontweight").css("display","none"),t.find(".re-setfontfamily").css("display","none"),t.find(".re-setfontsize").css("display","none"),t.find(".re-setlineheight").css("display","none"),t.find(".re-setalign").css("display","none"),t.find(".re-clearstyle").css("display","none")),this.$editor.parent().parent().parent().attr("data-redactor-nohref")),o=(void 0!==o&&!1!==o&&(t=$("#for_redactor_toolbar")).find(".re-link").css("display","none"),this.$editor.parent().parent().parent().attr("data-redactor-notoolbar"));void 0!==o&&!1!==o&&(t=$("#for_redactor_toolbar")).find(".redactor-toolbar").css("display","none"),"undefined"!=typeof $is_email&&"y"==$is_email&&((t=$("#for_redactor_toolbar")).find(".re-fontweight").css("display","none"),t.find(".re-setfontfamily").css("display","none"),t.find(".re-setfontsize").css("display","none"),t.find(".re-setlineheight").css("display","none"),t.find(".re-setalign").css("display","none"))},changeCallback:function(e){window.waschanged="yes"},dropdownShownCallback:function(e,t,o){redactor_showTextSyle(this)},blurCallback:function(e){var t;$("#for_redactor_toolbar").finish(),$("#mainmenu").finish(),$("#for_redactor_toolbar").animate({opacity:"0",top:"-60px"},400,"easeInCirc",function(){$("#for_redactor_toolbar").html(""),$("#mainmenu").animate({opacity:"1",top:"0px"},300,"easeOutCirc")}),window.waschanged?tp__record__saveEditedField(i,o):((t=$("#record"+i+" [field='"+o+"']")).html(tempdatafields[i][o]),t.data("noclickatthistime","yes"),t.click(tp__record__editField))},pasteBeforeCallback:function(e){return e=void 0!==e?(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=$.htmlClean(e,{format:!0,allowedTags:["div","span","p","h1","h2","h3","a","i","b","br","del","u","ul","ol","li","sup","sub","em","strike","strong"],allowedClasses:[""],allowedAttributes:[["href"],["style"],["rel"],["data-verified"],["data-redactor-tag"],["data-redactor-style"]]})).replace(/<h1\s(.*?)>/gi,"<h1>")).replace(/<h1><br\s?\/?><\/h1>/gi,"<br /><br />")).replace(/<h1>([\w\W]*?)<\/h1>/gi,"$1<br /><br />")).replace(/<h2\s(.*?)>/gi,"<h2>")).replace(/<h2><br\s?\/?><\/h2>/gi,"<br /><br />")).replace(/<h2>([\w\W]*?)<\/h2>/gi,"$1<br /><br />")).replace(/<h3\s(.*?)>/gi,"<h3>")).replace(/<h3><br\s?\/?><\/h3>/gi,"<br /><br />")).replace(/<h3>([\w\W]*?)<\/h3>/gi,"$1<br /><br />")).replace(/<div\s(.*?)>/gi,"<div>")).replace(/<div><br\s?\/?><\/div>/gi,"<br />")).replace(/<div>([\w\W]*?)<\/div>/gi,"$1<br />"):e}}))}function tp__record__saveEditedField(e,t,o){var i,r,d,n;void 0!==(o="q"===window.ver_redactor?$("#rec"+e+" [field="+t+"]").html():$("#textarearecord"+e+"field"+t).val())&&(o=o.replace(/&nbsp;/g," "),n="",null!=(i=$("#editrecord"+e+"field"+t)).attr("data-redactor-font-size")&&(n=n+"font-size:"+i.attr("data-redactor-font-size")+";"),null!=i.attr("data-redactor-line-height")&&(n=n+"line-height:"+i.attr("data-redactor-line-height")+";"),null!=i.attr("data-redactor-text-align")&&(n=n+"text-align:"+i.attr("data-redactor-text-align")+";"),null!=i.attr("data-redactor-font-family")&&(n=n+"font-family:"+i.attr("data-redactor-font-family")+";"),i=(o=""!=(n=null!=i.attr("data-redactor-color")?n+"color:"+i.attr("data-redactor-color")+";":n)?'<div style="'+n+'" data-customstyle="yes">'+o+"</div>":o).length,"li_"==t.substr(0,3)&&3e3<i&&td__showBubbleNotice(tc__translate("{{note_too_much_data}}","record__dict")),65e3<i&&"code"!=t?td__showBubbleNotice(tc__translate("{{error_too_much_data}}","record__dict")):(showLoadIcon(),r=Date.now(),(d={comm:"saverecord"}).pageid=window.pageid,d.recordid=e,d[t]=o,d.onlythisfield=t,$.ajax({type:"POST",url:"/page/submit/",data:d,dataType:"text",success:function(e){check_logout(e),""==e||"OK"==e?tp__showUndoButton():("too much data"==e&&(e=tc__translate("{{error_too_much_data}}","record__dict")),td__showBubbleNotice(e))},error:function(e){var t=Date.now()-r;if(0==e.status&&t<300)alert("Request error (saving text). Please check your Internet connection and try again.");else{try{errorLog({e:"saverecord",data:d,xhr:e.status,ts:t})}catch(e){}alert("Request timeout (saving text)")}},complete:function(e){hideLoadIcon()},timeout:6e4}),(n=$("#record"+e+" [field='"+t+"']")).html(o),""==o&&n.remove(),n.data("noclickatthistime","yes"),n.click(tp__record__editField)))}function tp__getRecordid(e){for(var t=0;!o&&t<16;){var o=e.attr("recordid");e=e.parent(),t++}return o||console.log("Error. Recordid not found"),o}function tp__htmlEncode(e){return $("<div/>").text(e).html()}function addRedactor_to_textarea(e){("q"===window.ver_redactor?tp__addRedactor_to_textarea_quill:tp__addRedactor_to_textarea_v2)(e)}function tp__addRedactor_to_textarea_quill(e){var t=e.val(),o=e.attr("placeholder"),i=e.parent(),r=e.parents(".pe-form-group")[0],d=e.attr("name"),r=$(r).attr("data-lid"),t=(e.css("display","none"),Quill.fixCustomStyle(t)),n=t.styles,t=(e.after('<div class="pe-redactor__wrapper" quill-name="'+d+'" quill-lid="'+r+'">'+t.html+"</div>"),"undefined"==typeof lang&&(lang="en"),{toolbar_content:{hint:!0,toolbarClass:"pe-redactor__toolbar",editorWrapper:i,showByClick:!0,callback:function(e){var t;"undefined"!=typeof $is_email&&"y"==$is_email&&((t=$(".pe-redactor__toolbar")).find(".ql-color_custom").css("display","none"),t.find(".ql-weight_custom").css("display","none"),t.find(".ql-font_custom").css("display","none"),t.find(".ql-size_custom").css("display","none"),t.find(".ql-lineheight_custom").css("display","none"),t.find(".ql-align_custom").css("display","none"))}},popup:!0,tooltip:!0,clipboard:!0,dropdown:!0,textcolor:".ql-color_custom",weightDropdown:".ql-weight_custom",fontDropdown:".ql-font_custom",sizeDropdown:".ql-size_custom",lineheightDropdown:".ql-lineheight_custom",alignDropdown:".ql-align_custom",typograph:".ql-typograph_custom",cleanstyle:".ql-clean_custom",tilda_hotkeys:!0,toolbar:{container:'[quill-name="'+d+'"][quill-lid="'+r+'"] + .pe-redactor__toolbar',toolbarOptions:["bold","italic","underline",{list:"ordered"},{list:"bullet"},"link"]},more:".ql-more_custom"}),a=(""!==window.lireplaces&&void 0!==window.lireplaces[d]&&null!=window.lireplaces[d].redactor_nohref||(t.tilda_link=".ql-link_custom"),new Quill(i.find(".pe-redactor__wrapper")[0],{placeholder:o||"",formats:["bold","color","font","italic","link","size","strike","underline","list","align","weight","lineheight","align","subscript","superscript","background"],debug:!1,modules:t}));Quill.setCustomStyles(a.root,n),a.on("editor-change",function(){window.waschanged="yes",e.val(Quill.getFormatContent(a.root))}),a.on("text-change",function(){window.edrec_isChanged="y"}),"object"==typeof window.lireplaces[d]&&"yes"==window.lireplaces[d].redactor_nohref&&i.find(".pe-redactor__toolbar").find(".ql-link_custom").css("display","none")}function tp__addRedactor_to_textarea_v2(e){"undefined"==typeof lang&&(lang="en"),e.redactor({lang:"RU"==lang?"ru":"en",linebreaks:!0,boldTag:"b",italicTag:"i",replaceDivs:!1,allowedTags:["p","a","i","b","br","div","del","u","ul","ol","li","hr","sup","sub","em","table","tr","td","th","tbody","thead","strike","span","inline","strong","h1","h2","h3","h4","h5","h6"],buttons:["bold","italic","deleted","link","unorderedlist","orderedlist",""],dragUpload:!1,plugins:"RU"==window.lang||"RU"==window.country||"BY"==window.country||"UA"==window.country?["underline","fontcolorex","fontweight","setfontfamily","setfontsize","setlineheight","setalign","typograf","clearstyle"]:["underline","fontcolorex","fontweight","setfontfamily","setfontsize","setlineheight","setalign","clearstyle"],initCallback:function(){this.$toolbar.css("display","none")},changeCallback:function(e){window.waschanged="yes"},focusCallback:function(e){var t;this.$toolbar.css("display","block"),1==this.$editor.has("div").is("div")&&(void 0!==(t=getAttrStrintoArr(this.$editor.find("div").attr("style")))["font-size"]&&""!=t["font-size"]&&this.setfontsize.enter(t["font-size"]),void 0!==t["line-height"]&&""!=t["line-height"]&&this.setlineheight.enter(t["line-height"]),void 0!==t["text-align"]&&""!=t["text-align"]&&this.setalign.enter(t["text-align"]),void 0!==t["font-family"]&&""!=t["font-family"]&&this.setfontfamily.enter(t["font-family"]),void 0!==t.color&&""!=t.color&&this.fontcolorex.enter(t.color),this.$editor.find("div").contents().unwrap())},blurCallback:function(e){var t,o,i;this.$toolbar.css("display","none"),window.waschanged&&(t=(t=this.$editor.html()).replace(/&nbsp;/g," "),o="",null!=(i=this.$box.parent()).attr("data-redactor-font-size")&&(o=o+"font-size:"+i.attr("data-redactor-font-size")+";"),null!=i.attr("data-redactor-line-height")&&(o=o+"line-height:"+i.attr("data-redactor-line-height")+";"),null!=i.attr("data-redactor-text-align")&&(o=o+"text-align:"+i.attr("data-redactor-text-align")+";"),null!=i.attr("data-redactor-font-family")&&(o=o+"font-family:"+i.attr("data-redactor-font-family")+";"),""!=(o=null!=i.attr("data-redactor-color")?o+"color:"+i.attr("data-redactor-color")+";":o)&&(this.$editor.html(t='<div style="'+o+'" data-customstyle="yes">'+t+"</div>"),this.code.sync()),setTimeout(function(){i.find("textarea").trigger("change")},100))},pasteBeforeCallback:function(e){return e=void 0!==e?(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=$.htmlClean(e,{format:!0,allowedTags:["div","span","p","h1","h2","h3","a","i","b","br","del","u","ul","ol","li","sup","sub","em","strike","strong"],allowedClasses:[""],allowedAttributes:[["href"],["style"],["rel"],["data-verified"],["data-redactor-tag"],["data-redactor-style"]]})).replace(/<h1\s(.*?)>/gi,"<h1>")).replace(/<h1><br\s?\/?><\/h1>/gi,"<br /><br />")).replace(/<h1>([\w\W]*?)<\/h1>/gi,"$1<br /><br />")).replace(/<h2\s(.*?)>/gi,"<h2>")).replace(/<h2><br\s?\/?><\/h2>/gi,"<br /><br />")).replace(/<h2>([\w\W]*?)<\/h2>/gi,"$1<br /><br />")).replace(/<h3\s(.*?)>/gi,"<h3>")).replace(/<h3><br\s?\/?><\/h3>/gi,"<br /><br />")).replace(/<h3>([\w\W]*?)<\/h3>/gi,"$1<br /><br />")).replace(/<div\s(.*?)>/gi,"<div>")).replace(/<div><br\s?\/?><\/div>/gi,"<br />")).replace(/<div>([\w\W]*?)<\/div>/gi,"$1<br />"):e}})}function tp__record__showTextStyle(e){var t=$(e.root);var o=parseInt(t.css("font-size")),i=t.css("font-family").replace(", serif","").replace(", sans-serif","").replace("'","").replace("'",""),r=[],d=[],t=function(e){for(var t,o=[],i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t=i.nextNode();)o.push(t);return o}(e.root),t=($.each(t,function(e,t){t=t.parentNode;r.push("font-family"===t.style[0]?$(t).css("font-family"):i),d.push("font-size"===t.style[0]?parseInt($(t).css("font-size").split("px")[0]):o)}),e=r.length===t.length,$.unique(r),$.unique(d),1===r.length&&e&&(i=r[0]),1<r.length&&(i="Mixed"),(o=1===d.length?d[0]:o)+"px, "+i),e=$("#for_redactor_toolbar");$("#rightfontinfo").remove(),$(".rightfontinfo-instruction").remove(),"RU"===window.lang?(e.append('<div id="rightfontinfo" style="position:absolute; z-index:2060;top:0px;right:82px; height:60px; line-height:60px; font-size:11px; opacity:0.7;">'+t+"</div>"),e.append('<a class="rightfontinfo-instruction" style="position: absolute; right: 49px; top: 19px;" target="_blank" href="http://help-ru.tilda.ws/text-editor"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.5"><circle cx="10" cy="10" r="9.5" transform="rotate(180 10 10)" stroke="black"/></g><path d="M10.2223 14.444C9.05556 13.932 12.1665 9.95545 10.8797 8.66169C10.0001 7.77733 8.88886 8.33317 8.33347 8.6621C8.29532 8.68469 8.40693 8.77548 8.38047 8.79872C8.57492 8.69375 9.69626 8.67496 9.58198 9.81569C9.48938 10.74 7.73007 13.3521 8.65601 14.7747C9.34153 15.828 11.0701 15.6635 12.1127 14.4336L12.0279 14.3396C11.1868 14.5943 10.7316 14.6676 10.2223 14.444Z" fill="#727272"/><circle cx="10.7776" cy="5.55545" r="1.11111" fill="#727272"/></svg></a>'),e.append('<a class="rightfontinfo-instruction" style="position: absolute; right: 14px; top: 15px;" target="_blank" href="https://youtu.be/8uiOpkY0vcQ"><svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.5"><circle cx="18.9356" cy="5.75084" r="4.60191" stroke="black"/><path d="M18.9341 8.81248L18.9341 4.73096" stroke="black"/><path d="M18.9341 3.71081L18.9341 2.69043" stroke="black"/><path d="M9.38974 16.0077V12.6164L11.7542 14.312L9.38974 16.0077Z" fill="black" stroke="black"/><path d="M11.7917 4.84569C11.3165 4.77113 10.8295 4.73242 10.3334 4.73242C5.17869 4.73242 1 8.91111 1 14.0658C1 19.2205 5.17869 23.3992 10.3334 23.3992C15.4881 23.3992 19.6667 19.2205 19.6667 14.0658C19.6667 13.6707 19.6422 13.2813 19.5945 12.8991" stroke="black"/></g></svg></a>')):(e.append('<div id="rightfontinfo" style="position:absolute; z-index:2060;top:0px;right:82px; height:60px; line-height:60px; font-size:11px; opacity:0.7;">'+t+"</div>"),e.append('<a class="rightfontinfo-instruction" style="position: absolute; right: 49px; top: 19px;" target="_blank" href="https://help.tilda.cc/text-editor"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.5"><circle cx="10" cy="10" r="9.5" transform="rotate(180 10 10)" stroke="black"/></g><path d="M10.2223 14.444C9.05556 13.932 12.1665 9.95545 10.8797 8.66169C10.0001 7.77733 8.88886 8.33317 8.33347 8.6621C8.29532 8.68469 8.40693 8.77548 8.38047 8.79872C8.57492 8.69375 9.69626 8.67496 9.58198 9.81569C9.48938 10.74 7.73007 13.3521 8.65601 14.7747C9.34153 15.828 11.0701 15.6635 12.1127 14.4336L12.0279 14.3396C11.1868 14.5943 10.7316 14.6676 10.2223 14.444Z" fill="#727272"/><circle cx="10.7776" cy="5.55545" r="1.11111" fill="#727272"/></svg></a>'),e.append('<a class="rightfontinfo-instruction" style="position: absolute; right: 14px; top: 15px;" target="_blank" href="https://youtu.be/_W8RMD-hKlQ"><svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.5"><circle cx="18.9356" cy="5.75084" r="4.60191" stroke="black"/><path d="M18.9341 8.81248L18.9341 4.73096" stroke="black"/><path d="M18.9341 3.71081L18.9341 2.69043" stroke="black"/><path d="M9.38974 16.0077V12.6164L11.7542 14.312L9.38974 16.0077Z" fill="black" stroke="black"/><path d="M11.7917 4.84569C11.3165 4.77113 10.8295 4.73242 10.3334 4.73242C5.17869 4.73242 1 8.91111 1 14.0658C1 19.2205 5.17869 23.3992 10.3334 23.3992C15.4881 23.3992 19.6667 19.2205 19.6667 14.0658C19.6667 13.6707 19.6422 13.2813 19.5945 12.8991" stroke="black"/></g></svg></a>'))}function redactor_showTextSyle(e){var e=e.$editor,t=(1==$(e).has("div").is("div")&&(e=e.children()),parseInt(e.css("font-size"))),o=parseInt(e.css("line-height")),i=e.css("font-family").replace(", serif","").replace(", sans-serif","").replace("'","").replace("'",""),e=t+"px, "+i,r=$("#for_redactor_toolbar").find(".redactor-toolbar");$("#rightfontinfo").remove(),r.after('<div id="rightfontinfo" style="position:absolute; z-index:2060;top:0px;right:20px; height:50px; line-height:50px; font-size:11px; opacity:0.7;">'+e+"</div>"),$(".redactor-dropdown-box-setfontsize").children().each(function(e){$(this).text()==t+"px"?($(this).css("background-color","#eeeeee"),$(this).parent().animate({scrollTop:$(this).position().top-85},400)):$(this).css("background-color","")}),$(".redactor-dropdown-box-setfontfamily").children().each(function(e){$(this).text()==i?$(this).css("background-color","#eeeeee"):$(this).css("background-color","")}),$(".redactor-dropdown-box-setlineheight").children().each(function(e){$(this).text().replace("px","")<=o&&$(this).next().text().replace("px","")>o?($(this).css("background-color","#eeeeee"),$(this).parent().animate({scrollTop:$(this).position().top-85},400)):$(this).css("background-color","")})}function getAttrStrintoArr(e){if(""==e||null==e||0==e)return"";for(var t,o=e.split(";"),i={},r=0,d=o.length;r<d;r++)t=o[r].split(":"),i[$.trim(t[0])]=$.trim(t[1]);return i}function tp__record__bufCut(t){0<t&&(showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"cutrecord_tobuf",pageid:window.pageid,recordid:t},dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),""!=e&&"OK"!=e||($(".record[data-cuted=yes]").css("opacity",""),$(".record").removeAttr("data-cuted"),$("#record"+t).css("opacity","0.5"),$("#record"+t).attr("data-cuted","yes"),showCornerNotice(tc__translate("{{copied_to_clipboard}}","record__dict"),3e3))},error:function(){hideLoadIcon(),alert("Request timeout (block cutting to buffer)")},timeout:3e4}))}function tp__record__bufCopy(e){0<e&&(showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"copyrecord_tobuf",pageid:window.pageid,recordid:e},dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),""==e||"OK"==e?($(".record[data-cuted=yes]").css("opacity",""),$(".record").removeAttr("data-cuted")):console.log(e)},error:function(){hideLoadIcon(),alert("Request timeout (block coping to buffer)")},timeout:3e4}))}function tp__selectedrecords__bufCopy(){var e=Array();$(".record_selected","#allrecords").each(function(){e.push($(this).attr("id").replace("record",""))}),0<e.length&&(showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"copyselectedrecords_tobuf",pageid:window.pageid,selects:e},dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),""!=e&&"OK"==e||(showCornerNotice(tc__translate("{{copied_to_clipboard_use_paste}}","record__dict"),4e3),window.somerecordsinbuffer="yes",tp__updateSelectModeButtons())},error:function(){hideLoadIcon(),alert("Request timeout (coping blocks to buffer)")},timeout:3e4}))}function tp__record__bufPaste(o){showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"pasterecord_frombuf",pageid:window.pageid,recordid:o},dataType:"text",success:function(e){var t;hideLoadIcon(),check_logout(e),""!==e&&("no data in buffer"==e?alert(tc__translate("{{nothing_to_paste}}","record__dict")):($("#record"+o).after(e),0<(t=$(e).attr("id"))&&($("#"+t).css("opacity","0"),$("#"+t).animate({opacity:"1"},700,"easeInCirc"),$("html, body").animate({scrollTop:$("#"+t).offset().top-100},700)),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList(),showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"delrecord_incutbuf",pageid:window.pageid},dataType:"text",success:function(e){hideLoadIcon(),check_logout(e),$("html, body").animate({scrollTop:$("#"+t).offset().top-100},700),0<e&&($("#record"+e).remove(),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList(),$("html, body").stop(),$("html, body").animate({scrollTop:$("#"+t).offset().top-100},700))}})))}})}function tp__selectModeOn(e){tp__hideSortButtons(),tp__showSelectButtons(),tp__updateSelectModeButtons(),tp__hideEditRecordsButtons(),$("[field]").off(),$("[imgfield]").off(),$(".record").click(function(){$(this).toggleClass("record_selected"),$(this).toggleClass("active"),tp__updateSelectModeButtons()}),void 0!==e&&($("#record"+e).toggleClass("record_selected"),$("#record"+e).toggleClass("active"),tp__updateSelectModeButtons()),showCornerNotice(tc__translate("{{block_operation_mode}}","record__dict"),5e3)}function tp__deleteRecordsSelected(){var r=Array();$(".record_selected","#allrecords").each(function(){r.push($(this).attr("id").replace("record",""))}),showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"deleterecordsselected",pageid:window.pageid,selects:r},dataType:"text",success:function(e){check_logout(e),hideLoadIcon();for(var t=0;t<r.length;t++){var o=r[t],i=$("#record"+o);i.slideUp("fast",function(){i.remove()})}$(".record").removeClass("record_selected"),tp__updateSelectModeButtons(),tp__updateUndoButton(),void 0!==window.blockList&&window.blockList.rebuildList(),""!=e&&console.log(e)}})}function tp__cancelSelect(){tp__hideSelectButtons(),location.reload()}function tp__showSelectButtons(){var e=tc__translate('<div id="saveselectbuttons"><button class="btn default btn-lg" onclick="cancelSelect();" style="margin-right: 18px">{{exit_from_select_mode}}</button> <button class="btn btn-primary btn-lg" id="selectmodebtn-move" onclick="selected_records_movemodeon();" style="margin-right: 9px">{{move}}</button><button class="btn btn-primary btn-lg" id="selectmodebtn-del" onclick="deleteRecordsSelected();" style="margin-right: 9px">{{delete}}</button><button class="btn btn-primary btn-lg" id="selectmodebtn-copy" onclick="selected_records_buf_copy();" style="margin-right: 9px">{{copy}}</button><button class="btn btn-primary btn-lg" id="selectmodebtn-paste" onclick="selected_records_pastemodeon();">{{paste}}</button></div>',"record__dict");document.body.insertAdjacentHTML("beforeend",e);document.getElementById("saveselectbuttons").style.display="block",document.querySelectorAll(".record").forEach(e=>e.style.cursor="pointer");e=tc__translate('<div id="select_records_toolbar"><div class="select_records_toolbar__left">{{block_selection_mode}}</div><div class="select_records_toolbar__right"><a href="javascript:cancelSelect();">{{back_to_editing}}</a></div></div>',"record__dict");document.body.insertAdjacentHTML("beforeend",e),$("#mainmenu").animate({opacity:"0",top:"-50px"},400,"easeInCirc",function(){$("#select_records_toolbar").animate({opacity:"1",top:"0px"},300,"easeOutCirc")})}function tp__hideSelectButtons(){document.querySelectorAll(".record").forEach(e=>e.style.cursor="auto"),document.getElementById("saveselectbuttons").style.display="none"}function tp__hideEditRecordsButtons(){$(".record").off("hover"),$(".recordediticons").css("display","none"),$(".recordediticons").css("display","none"),$(".recordbordertop").css("display","none"),$(".recordborderbottom").css("display","none"),$(".insertafterrecorbutton").css("display","none"),$("#shortcuttooldiv").css("display","none"),$("#dragsingleimagescont").css("display","none")}function tp__updateSelectModeButtons(){var e=Array();$(".record_selected","#allrecords").each(function(){e.push($(this).attr("id").replace("record",""))}),0<e.length?($("#selectmodebtn-move").css("display","inline-block"),$("#selectmodebtn-del").css("display","inline-block"),$("#selectmodebtn-copy").css("display","inline-block")):($("#selectmodebtn-move").css("display","none"),$("#selectmodebtn-del").css("display","none"),$("#selectmodebtn-copy").css("display","none")),void 0!==window.somerecordsinbuffer?$("#selectmodebtn-paste").css("display","inline-block"):$("#selectmodebtn-paste").css("display","none")}function tp__selectedrecords__movemodeon(){window.selectsarr=Array(),$(".record_selected","#allrecords").each(function(){window.selectsarr.push($(this).attr("id").replace("record",""))});for(var e=0;e<selectsarr.length;e++){var t=selectsarr[e];$("#record"+t).css("opacity","0.15")}$(".record").removeClass("record_selected"),$(".record").off("click"),tp__updateSelectModeButtons(),$(".record","#allrecords").each(function(){var e='<div class="recordborderbottom"></div>';e+='<div class="insertafterrecorbutton"><center><a href="javascript:tp__moveSelectedRecords(\''+$(this).attr("id").replace("record","")+'\');"><span class="glyphicon glyphicon-plus-sign" style="color:#000; width:20px; height:20px;"></span></a></center></div>',$(this).append("<div class='moveplacer'>"+e+"</div>")}),$(".record").mouseover(function(){$(".moveplacer").css("display","none"),$(this).find(".moveplacer").css("display","block")}),$(".record").click(function(){tp__moveSelectedRecords($(this).attr("id").replace("record",""))}),showCornerNotice(tc__translate("{{click_the_block_v1}}","record__dict"),8e3)}function tp__moveSelectedRecords(e){0<window.selectsarr.length&&(showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"moveselectedrecords",pageid:window.pageid,recordid:e,selects:window.selectsarr},dataType:"text",success:function(e){check_logout(e),hideLoadIcon(),window.location.href="https://tilda.cc/page/?pageid="+window.pageid+"#scrolltorecord="+window.selectsarr[0],window.location.reload(!0)}}))}function tp__selectedrecords__pastemodeon(){$(".record").removeClass("record_selected"),$(".record").removeClass("active"),$(".record").off("click"),delete window.somerecordsinbuffer,tp__updateSelectModeButtons(),$(".record","#allrecords").each(function(){var e='<div class="recordborderbottom"></div>';e+='<div class="insertafterrecorbutton"><center><a href="javascript:tp__pasteSelectedRecords(\''+$(this).attr("id").replace("record","")+'\');"><span class="glyphicon glyphicon-plus-sign" style="color:#000; width:20px; height:20px;"></span></a></center></div>',$(this).append("<div class='moveplacer'>"+e+"</div>")}),$(".record").mouseover(function(){$(".moveplacer").css("display","none"),$(this).find(".moveplacer").css("display","block")}),$(".record").click(function(){tp__pasteSelectedRecords($(this).attr("id").replace("record",""))}),showCornerNotice(tc__translate("{{click_the_block_v2}}","record__dict"),8e3)}function tp__pasteSelectedRecords(t){showLoadIcon(),"y"!=window.prevent_dubble_PasteCall&&(window.prevent_dubble_PasteCall="y",$.ajax({type:"POST",url:"/page/submit/",data:{comm:"pasterecord_frombuf",pageid:window.pageid,recordid:t},dataType:"text",success:function(e){hideLoadIcon(),""!==e&&(check_logout(e),"no data in buffer"==e?alert("Nothing to Paste"):($("#record"+t).after(e),e=$(e).attr("id").replace("record",""),$("html, body").animate({scrollTop:$("#record"+e).offset().top-100},700),window.location.href="https://tilda.cc/page/?pageid="+window.pageid+"#scrolltorecord="+e,window.location.reload(!0))),window.location.reload(!0)}}))}function tp__savesortmodeifactive(){("block"==$("#savesortbuttons").css("display")||0<autosavesort_timer)&&tp__saveRecordsSort()}var autosavesort_timer;function tp__sortModeOn(){tp__hideSelectButtons(),$("#allrecords").sortable({helper:"clone",opacity:.8,revert:!0,tolerance:"pointer",handle:"#sorthandle",axis:"y",start:function(e,t){clearTimeout(autosavesort_timer)},change:function(e,t){clearTimeout(autosavesort_timer)},update:function(e,t){tp__showSortButtons(),void 0!==window.blockList&&window.blockList.rebuildList(),autosavesort_timer=setTimeout(function(){tp__saveRecordsSort()},7e3)}})}function tp__cancelSort(){tp__hideSortButtons(),location.reload()}function tp__saveRecordsSort(){clearTimeout(autosavesort_timer),0<autosavesort_timer&&(autosavesort_timer=void 0);var e=Array();$("#allrecords .record").each(function(){e.push($(this).attr("id").replace("record",""))}),tp__ajax("/page/submit/",{comm:"saverecordssort",pageid:window.pageid,sorts:e},{ctext:"save blocks order"},function(e){hideLoadIcon(),check_logout(e),""!=e&&"OK"!=e||(tp__hideSortButtons(),tp__updateUndoButton())},function(){setTimeout(function(){location.reload()},3e3)})}function tp__showSortButtons(){$("#savesortbuttons").css({display:"block"}),$(".sortupicon").css({display:"block"}),$(".sortdownicon").css({display:"block"}),$(".sortonicon").css({display:"none"})}function tp__hideSortButtons(){$("#savesortbuttons").css({display:"none"}),$(".sortupicon").css({display:"none"}),$(".sortdownicon").css({display:"none"}),$(".sortonicon").css({display:"block"})}function tp__convertRecordtoZero(e){$(".pe-zero-convert-btn").css("display","none"),$(".pe-zero-convert-notice").css("display","block");var t="display: -webkit-flex; display: flex; -webkit-align-items: center; align-items: center; box-sizing: border-box; width: 240px; padding: 15px 20px; cursor: pointer; ",o="",o=(o=(o+='<div style="font-size:14px; color:#777; padding-top:25px;">')+"{{convert_warning}}"+('<a href="javascript:tp__convertRecordtoZero_do('+e+');" style="'+t+' margin-top:10px; background-color:#000; color:#fff;">{{convert}}</a>'))+('<a href="javascript:tp__convertRecordtoZero_cancel();" style="'+t+'margin-top:5px; border:1px solid rgba(0,0,0,0.1);">{{cancel}}</a>')+"</div>";o=tc__translate(o,"record__dict"),$(".pe-zero-convert-notice").html(o)}function tp__convertRecordtoZero_cancel(){$(".pe-zero-convert-btn").css("display","block"),$(".pe-zero-convert-notice").css("display","none")}function tp__convertRecordtoZero_do(t){showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"converttozero",pageid:window.pageid,recordid:t},dataType:"text",success:function(e){hideLoadIcon(),""==e||"OK"==e?(edrec__closeEditForm(),$("html, body").animate({scrollTop:$("#record"+t).offset().top-100},700),tp__updateRecord(t)):(check_logout(e),alert(e)),tp__updateUndoButton()},error:function(){alert("Request error (convert block to ZeroBlock)"),hideLoadIcon(),location.reload()},timeout:25e3})}function tp__openZero(e,t){var o=window.pageid,i=(console.log("func: tn_openeditor"),$("body")),r=(i.addClass("t396__body_overflow_hidden"),i.attr("data-zero-opened-recordid",e),$("#intercom-container").addClass("t396__display_none"),Math.random().toString(36).substring(7));i.append("<iframe class='t396__iframe' src=\"/zero/?recordid="+e+"&pageid="+o+"&iframe=y&nocash="+r+'" width="100vw" height="100vh"></iframe>'),$(".t396__iframe").focus(),window.history.replaceState&&("replacestate"==t?window.history.replaceState({module:"zero",recordid:e},"","/zero/?recordid="+e+"&pageid="+o):window.history.pushState({module:"zero",recordid:e},"","/zero/?recordid="+e+"&pageid="+o))}function tn_close(e,t){tp__closeZero(e,t)}function tp__closeZero(e,t){void 0===e&&void 0!==(e=$("body").attr("data-zero-opened-recordid"))&&""!=e&&(e=+e),console.log("func: tn_close. rec:"+e),$(".t396__iframe").remove();var o=$("body");o.removeClass("t396__body_overflow_hidden"),o.removeAttr("data-zero-opened-recordid"),$("#intercom-container").removeClass("t396__display_none"),0<e&&(tp__updateRecord(e),o=$("#record"+e).offset())&&$("html, body").animate({scrollTop:o.top-100},700),window.history.replaceState&&0<t&&window.history.pushState(null,"","/page/?pageid="+t)}function tui_editimage(e,r,d){var t=document.querySelector('img[id="'+r+'"]').getAttribute("src");"function"!=typeof hideLoadIcon&&(window.hideLoadIcon=function(){$("#loadicon").css({display:"none"})}),"function"!=typeof showLoadIcon&&(window.showLoadIcon=function(){$("#loadicon").css({display:"block"})}),window.upload_saveAs=function(e,t){"function"!=typeof showLoadIcon&&$("body").append('<div id="loadicon" style="display: none; position: fixed; z-index: 1200; padding: 0; left: 10px; top: 60px;"><img src="/tpl/img/ajax-loader.gif"></div>'),showLoadIcon(),(tu=TUWidget.init($(".tui-image-editor-canvas-container").eq(0))).done(function(e){var t,o,i;e.tuInfo&&e.tuInfo.cdnUrl&&(t=e.tuInfo.cdnUrl,null!=(o=document.getElementById(r))&&(o.src=t),"function"==typeof d?d(r,e.tuInfo):0<(o=$("#"+r).closest(".js-image-box")).length?(o.find(".js-img-cdnurl").val(t),o.find(".js-img-uuid").val(""),o.find(".js-img-name").val(""),o.find(".js-img-size").val(""),o.find(".js-img-width").val(""),o.find(".js-img-height").val(""),i=t.substring(t.length-30),o.find(".js-img-title").attr("href",t).html("..."+i),0<e.tuInfo.width&&o.find("js-img-width").val(e.tuInfo.width)):console.log(t),"function"==typeof window.tuiEditor.destroy&&window.tuiEditor.destroy(),$("#tuiEditorTildaWidget").remove(),window.tuiEditor=!1,hideLoadIcon())}).fail(function(){"function"==typeof window.tuiEditor.destroy&&window.tuiEditor.destroy(),$("#tuiEditorTildaWidget").remove(),window.tuiEditor=!1,hideLoadIcon()}),tu.uploadFileFromURL(e)},window.tuiEditor&&(document.querySelector(".tui__editor-container").style.display="block"),tui_onReady(t)}function tui_initImageEditor(e){0<e.indexOf("ucarecdn")||0<e.indexOf("tildacdn.info")?(t=e.lastIndexOf("/"))!=e.length-1&&(e=e.substring(0,t+1)):"/"==e.substring(0,1)&&(e="https://tilda.cc"+e);var t={includeUI:{menu:["newSize","crop","flip","rotate","text","draw","filter"],loadImage:{path:e,name:"SampleImage"},menuBarPosition:"top",usageStatistics:!1},cssMaxWidth:800,cssMaxHeight:600,usageStatistics:!1};"RU"===window.lang&&(t.includeUI.locale={Undo:"",Redo:"",Reset:"",Delete:"","Delete-all":" ",Rotate:"",Save:"",Width:"",Height:"","Lock proportion":" ",Custom:"",Crop:"",Apply:"",Cancel:"",Flip:"","Flip X":" ","Flip Y":" ",Angle:"",Text:" ",Bold:"",Italic:"",Underline:"",Left:"",Center:" ",Right:"",Color:"","Text size":"",Draw:" ",Free:"",Straight:"",Size:"",Filter:" ",Grayscale:" ",Sepia:"",Blur:"",Emboss:"",Invert:"",Sepia2:" 2",Sharpen:"","Remove White":"  ",Distance:"",Value:"",Brightness:"",Noise:"",Pixelate:"","Color Filter":" ",Threshold:""}),window.tuiEditor=new tui.ImageEditor("#tui-image-editor-container",t),window.onresize=function(){window.tuiEditor?window.tuiEditor.ui.resizeEditor():setTimeout(function(){window.onresize()},300)}}function tui_onReady(e){var t;window.tuiEditor?(t=e.split("/"),window.tuiEditor.loadImageFromURL(e,t?t[t.length-1]:"photo")):window.tuiEditorLoad?(tui_addTuiContainer(),tui_initImageEditor(e)):0==$("#tuiEditorTildaScriptVersion").length&&((t=document.createElement("link")).rel="stylesheet",t.id="tuiEditorStyle",t.href="/front/css/tui.min.css",document.documentElement.appendChild(t),"RU"===window.lang&&((t=document.createElement("style")).id="tuiEditorStyleRussian",t.textContent=".tui-image-editor-container .color-picker-control .tui-image-editor-range {width: 75px;}.tui-image-editor-container .tui-image-editor-submenu-align:first-child label {width: 95px;}.tui-image-editor-container .tui-image-editor-submenu-align label {width: 75px;}.tui-image-editor-container .tui-image-editor-checkbox-wrap.fixed-width {width: 230px;}",document.documentElement.appendChild(t)),(t=document.createElement("script")).src="/front/js/tui-im-edit.min.js",t.id="tuiEditorTildaScriptVersion",document.documentElement.appendChild(t),t.onload=t.onerror=function(){window.tuiEditorLoad=!0,this.executed||(this.executed=!0,tui_onReady(e))},t.onreadystatechange=function(){var e=this;"complete"!=this.readyState&&"loaded"!=this.readyState||setTimeout(function(){e.onload()},0)})}function tui_addTuiContainer(){0<$("#tuiEditorTildaWidget").length&&($("#tuiEditorTildaWidget").remove(),window.tuiEditor=!1);var e=document.createElement("div");e.id="tuiEditorTildaWidget",e.className="tui__editor-container",e.innerHTML='<div class="tui__editor-fullscreen_bg"></div><div class="tui__editor-wrap"><div class="tui__editor-header"><span>Photo Editor</span><span class="tui__editor-header-close"></span></div><div id="tui-image-editor-container"></div></div>',document.documentElement.appendChild(e),document.querySelector(".tui__editor-header-close").onclick=function(){e.style.display="none",window.tuiEditor=!1,$("#tuiEditorTildaWidget").remove()}}function openImageSearchPopup(t,e,o,i){o=o||"",showLoadIcon(),$.cachedScript("https://front.tildacdn.com/ccimagesearch/js/t__imagesearch.min.js").done(function(){0==$("#css-tis-imagesearch").length&&$("body").append('<link id="css-tis-imagesearch" rel="stylesheet" href="https://front.tildacdn.com/ccimagesearch/css/t_imagesearch.min.css">'),window.tis__imgid&&window.tis__userid&&window.tis__userhash?(hideLoadIcon(),tis__showImageSearch(t,window.tis__userid,window.tis__userhash,void 0,i)):$.ajax({type:"POST",url:"/projects/get/getimagesearch/",data:{imgid:e,recid:o,v:2},dataType:"text",success:function(e){check_logout(e),(e=$.parseJSON(e)).userid?(hideLoadIcon(),window.tis__userid=e.userid,window.tis__userhash=e.userhash,tis__showImageSearch(t,e.userid,e.userhash,void 0,i)):alert("Not found user")},error:function(){alert("Request Timeout"),location.reload()},timeout:3e4})})}function tp__record__getDictObj(e){var t="DE"===e?{settings:"Einstellungen",content:"Inhalt",block_editor:"Block-Editor",products:"Produkte",posts:"Beitrge",note_diff_edit_and_publish:"Das Erscheinungsbild dieses Blocks im Bearbeitungsmodus kann sich von seinem Erscheinungsbild in der Vorschau und auf der verffentlichten Seite unterscheiden",duplicate:"Duplizieren",delete:"Lschen",hide_show:"Ausblenden/Einblenden",cut:"Ausschneiden",copy:"Kopieren",paste:"Einfgen",select:"Auswhlen",move_up:"Nach oben bewegen",move_down:"Nach unten bewegen",from:" ",to:"-",set_width_viewport_limit:"Fr diesen Block gilt eine Anzeigebeschrnkung. Dieser Block wird nur auf Bildschirmen mit der angegebenen Breite angezeigt.",recover_from_trash:"Aus dem Papierkorb wiederherstellen",save_content_on_switch:"&nbsp;Inhalt beim Umschalten beibehalten",block_may_look_unbalanced:"Der gewhlte Block knnte aufgrund der unterschiedlichen Struktur<br> unausgewogen aussehen, und Sie mssen eventuell die Einstellungen<br> anpassen oder den Inhalt ndern.",maps_google_critycal_text:'<b>Achtung:</b> Google-Maps-API-Schlssel nicht gefunden. Bitte geben Sie den Schlssel auf der Registerkarte [Inhalt] ein. <a href="https://developers.google.com/maps/documentation/javascript/get-api-key?hl=ru" target="_blank">Google-Maps-API-Schlssel anfordern</a><br>Lesen Sie die Anleitung in unserem <a href="http://help.tilda.ws/google-maps" style="color:#fa8669 !important;" target="_blank">Hilfe-Center</a>',maps_yandex_critycal_text:"<b>Achtung:</b> Yandex-Maps-API-Schlssel nicht gefunden. Bitte geben Sie den Schlssel in der Registerkarte [Inhalt] ein.",forms_success_connected:"Das Formular wurde zugewiesen. Aktuelle Einstellungen:<br>Daten werden von diesen Domains empfangen:  ",forms_data_will_be_sent:"Die Daten werden gesendet an:",forms_has_not_script:"<b>Achtung:</b> Die Formularzuweisung ist nicht abgeschlossen. Sie haben Eigenes Skript fr den Datenempfang  eingestellt, aber Sie haben keine Skriptadresse angegeben. Bitte geben Sie eine Skriptadresse an, an die die Daten aus dem Formular gesendet werden sollen. Oder, um unseren Datenerfassungsdienst zu nutzen, weisen Sie in den Website-Einstellungen den Datenempfnger zu.",forms_has_not_data_receiver:"<b>Achtung:</b> Die Zuweisung des Formulars ist nicht abgeschlossen. Bitte klicken Sie auf die Schaltflche Inhalt dieses Blocks und aktivieren Sie das Kstchen fr den Datenempfnger.",forms_page_need_publish:"Seite bitte verffentlichen",blocks_critycal_text:"Dieser Block ist veraltet und wird nicht mehr untersttzt. Er funktioniert mglicherweise nicht richtig. Bitte fgen Sie die neue Version des Blocks aus der Bibliothek hinzu oder passen Sie den entsprechenden Block an. Verschieben Sie den Inhalt in den neuen Block und verffentlichen Sie die Seite erneut.",hidden_block:"Dieser Block ist ausgeblendet. Drcken Sie auf die Schaltflche Ausblenden/Einblenden auf der rechten Seite, um ihn zu aktivieren.",convert_warning:"Die Konvertierung in Zero Block hat zur Folge, dass der Block wieder so aussieht wie zu Beginn  mit Standardtext und -fotos. Wenn Sie Text und Fotos in Ihre eigenen ndern, werden diese nicht gespeichert.",convert:"Konvertieren, ohne den Inhalt zu speichern",cancel:"Abbrechen",note_too_much_data:"Hinweis: Zu viele Daten in diesem Eingabefeld. Wir empfehlen dringend, die Menge der Informationen zu reduzieren.",error_too_much_data:"Fehler: Zu viele Daten. Die nderungen werden nicht gespeichert. Bitte lschen Sie einen Teil der Informationen.",copied_to_clipboard:"Die Blcke werden in die Zwischenablage kopiert",copied_to_clipboard_use_paste:"Blcke in die Zwischenablage kopiert",nothing_to_paste:"Nichts zum Einfgen",block_operation_mode:"Block-Operationsmodus: <b>Klicken Sie auf den Block, um ihn auszuwhlen.</b>",block_selection_mode:"Block-Auswahlmodus: <b>Klicken Sie auf den Block, um ihn auszuwhlen.</b>",back_to_editing:"Zurck zum Bearbeiten</a>",exit_from_select_mode:"Auswahlmodus beenden",move:"Bewegen",click_the_block_v1:"Klicken Sie auf den Block, hinter den Sie die ausgewhlten Blcke setzen mchten.",click_the_block_v2:"Klicken Sie auf den Block, hinter den Sie Blcke aus der Zwischenablage einfgen mchten."}:"EN"===e?{settings:"Settings",content:"Content",block_editor:"Block Editor",products:"Products",posts:"Posts",note_diff_edit_and_publish:"Appearance of this block in the editing mode might be different from its appearance on preview and on published page.",duplicate:"Duplicate",delete:"Delete",hide_show:"Hide/Show",cut:"Cut",copy:"Copy",paste:"Paste",select:"Select",move_up:"Move up",move_down:"Move down",from:" ",to:"-",set_width_viewport_limit:"There's a display restriction applied to this block. This block will appear only on screens with the specified width.",recover_from_trash:"Recover from Trash",save_content_on_switch:"&nbsp;Keep content on switch",block_may_look_unbalanced:"The chosen block may look unbalanced due to the different structure,<br> and you may need to adjust the settings or modify the content.",maps_google_critycal_text:'<b>Attention:</b> Google Maps API key not found. Please, input key in [Content] tab. <a href="https://developers.google.com/maps/documentation/javascript/get-api-key?hl=ru" target="_blank">Get Google Maps API key</a><br>Read the instruction in our <a href="http://help.tilda.ws/google-maps" style="color:#fa8669 !important;" target="_blank">Help Center</a>',maps_yandex_critycal_text:"<b>Attention:</b> Yandex Maps API key not found. Please, set key in [Content] tab.",forms_success_connected:"Form has been assigned. Current settings:<br>Data will be received from domains: ",forms_data_will_be_sent:"Data will be sent to:",forms_has_not_script:"<b>Attention:</b> form assigning is not completed. Youve set Own script for receiving data , but you didnt put down a script address. Please put down a script address to which data from the form has been sent. Or, to use our service of data capture, assign Data Receiver in the Site Settings.",forms_has_not_data_receiver:"<b>Attention:</b> form assigning is not completed. Please press the button Content of this block and check the box across the Data Receiver.",forms_page_need_publish:"Publish page please",blocks_critycal_text:"This block is outdated and is not supported anymore. It may work incorrectly. Please add the new version of the block from the library or match the analogic one. Move the content to the new block and re-publish a page.",hidden_block:"This block is hidden. Press on 'Hide/Show' button on the right side to activate it.",convert_warning:"As a result of converting to Zero Block, the block will return to its starting appearance with default text and photos. If you change text and photos to your own ones they will not be saved.",convert:"Convert without saving content",cancel:"Cancel",note_too_much_data:"Note: Too much data in this input field. We strongly recommend reducing the amount of information.",error_too_much_data:"Error: Too much data. Changes will not be saved. Please delete some of the information.",copied_to_clipboard:"The block are copied to the clipboard",copied_to_clipboard_use_paste:"Blocks copied to the clipboard",nothing_to_paste:"Nothing to paste",block_operation_mode:"Block operation mode: <b>click on the block to select.</b>",block_selection_mode:"Block selection mode: <b>click block to select.</b>",back_to_editing:"Back to editing</a>",exit_from_select_mode:"Exit from select mode",move:"Move",click_the_block_v1:"Click the block after which you want to put the selected blocks.",click_the_block_v2:"Click the block after which you want to insert blocks from the clipboard."}:"RU"===e?{settings:"",content:"",block_editor:" ",products:"",posts:"",note_diff_edit_and_publish:":                  .",duplicate:"",delete:"",hide_show:"/",cut:"",copy:"",paste:"",select:"",move_up:" ",move_down:" ",from:" ",to:"",set_width_viewport_limit:"       .       .",recover_from_trash:"  ",save_content_on_switch:"&nbsp;   ",block_may_look_unbalanced:",      -   <br>,       .",maps_google_critycal_text:'<b>:</b> Google Maps API key  .      . <a href="https://developers.google.com/maps/documentation/javascript/get-api-key?hl=ru" target="_blank">   Google Maps</a><br>     <a href="http://help-ru.tilda.ws/google-maps" style="color:#fa8669 !important;" target="_blank"> </a>',maps_yandex_critycal_text:'<b>:</b> Yandex Maps API key  .      . <a href="http://help-ru.tilda.ws/yandex-maps" target="_blank">   Yandex Maps</a>',forms_success_connected:"  .  :<br>,     : ",forms_data_will_be_sent:"  :",forms_has_not_script:"<b>:</b>    .         ,     . ,  ,       . ,      ,     ${abeg} ${aend}.",forms_has_not_data_receiver:"<b>:</b>    . ,           .",forms_page_need_publish:"  ,    ",blocks_critycal_text:"      .    . ,         .        .",hidden_block:" .   / ,    .",convert_warning:"             .",convert:"",cancel:"",note_too_much_data:":     .    .",error_too_much_data:":   .    . ,   .",copied_to_clipboard:"   ",copied_to_clipboard_use_paste:"   . <b>  </b>",nothing_to_paste:"  ",block_operation_mode:"    : <b>  ,   .</b>",block_selection_mode:"    : <b>  ,   .</b>",back_to_editing:"  ",exit_from_select_mode:"  ",move:"",click_the_block_v1:"   ,       .",click_the_block_v2:"   ,        ."}:{};window.record__dict||(window.record__dict={}),window.record__dict[e]=t}window.onpopstate=function(e){void 0===e.state||null===e.state?$("body").hasClass("t396__body_overflow_hidden")&&tp__closeZero():void 0!==e.state.module&&"zero"==e.state.module&&tp__openZero(e.state.recordid,"replacestate")};
